2024-01-03 15:57:00,967 INFO: {'model_name': 'google/flan-t5-base', 'tokenizer_name': 'google/flan-t5-base'} 
2024-01-03 15:57:00,967 INFO: {'seed': 114514, 'lr': 0.001, 'n_epochs': 20, 'batch_size': 8, 'max_input_length': 256, 'max_output_length': 32, 'weight_decay': 0.01, 'gradient_accumulation_steps': 4, 'lora': {'r': 32, 'alpha': 32, 'target_modules': ['q', 'v'], 'dropout': 0.05, 'bias': 'none'}, 'output_dir': 'output', 'evaluation_strategy': 'steps', 'eval_steps': 300, 'save_strategy': 'steps', 'save_steps': 300, 'logging_strategy': 'steps', 'logging_steps': 300, 'report_to': 'tensorboard', 'save_model_dir': 'results', 'logging_dir': 'logs', 'metrics': ['bleu', 'rouge', 'perplexity']} 
2024-01-03 15:57:47,612 WARNING: Using the latest cached version of the module from /home/lin/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--bleu/9e0985c1200e367cce45605ce0ecb5ede079894e0f24f54613fca08eeb8aff76 (last modified on Wed Jan  3 12:27:06 2024) since it couldn't be found locally at evaluate-metric--bleu, or remotely on the Hugging Face Hub. 
2024-01-03 15:57:47,622 INFO: Loaded bleu... 
2024-01-03 15:58:34,273 WARNING: Using the latest cached version of the module from /home/lin/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--rouge/b01e0accf3bd6dd24839b769a5fda24e14995071570870922c71970b3a6ed886 (last modified on Wed Jan  3 12:27:09 2024) since it couldn't be found locally at evaluate-metric--rouge, or remotely on the Hugging Face Hub. 
2024-01-03 15:58:34,640 INFO: Loaded rouge... 
2024-01-03 15:59:21,269 WARNING: Using the latest cached version of the module from /home/lin/.cache/huggingface/modules/evaluate_modules/metrics/evaluate-metric--perplexity/8ab643ad86f568b7d1d5f7822373fa7401ff5ff0297ccf114b0ca6a33be96bc0 (last modified on Wed Jan  3 12:27:12 2024) since it couldn't be found locally at evaluate-metric--perplexity, or remotely on the Hugging Face Hub. 
2024-01-03 15:59:21,277 INFO: Loaded perplexity... 
2024-01-03 15:59:38,013 INFO: Successfully loaded dataset 
2024-01-03 15:59:40,615 INFO: Train dataset size: 10191 
2024-01-03 15:59:40,615 INFO: Test dataset size: 2295 
2024-01-03 15:59:40,616 INFO: Valid dataset size: 2156 
2024-01-03 15:59:40,616 INFO: trainable params: 3,538,944 || all params: 251,116,800 || trainable%: 1.40928205520299722024-01-03 16:13:47,884 INFO: Computing bleu... 
2024-01-03 16:13:48,366 INFO: Computing rouge... 
2024-01-03 16:13:48,378 INFO: Using default tokenizer. 
2024-01-03 16:13:49,700 INFO: Computing perplexity... 
2024-01-03 16:13:57,618 INFO: bleu-2: 0.2678117186650723 
2024-01-03 16:13:57,618 INFO: rouge-L: 0.16381007865872635 
2024-01-03 16:13:57,618 INFO: perplexity: 19.81121503621174 
2024-01-03 16:28:15,370 INFO: Computing bleu... 
2024-01-03 16:28:15,806 INFO: Computing rouge... 
2024-01-03 16:28:15,820 INFO: Using default tokenizer. 
2024-01-03 16:28:17,189 INFO: Computing perplexity... 
2024-01-03 16:28:25,433 INFO: bleu-2: 0.31966247291801286 
2024-01-03 16:28:25,434 INFO: rouge-L: 0.1943288896490387 
2024-01-03 16:28:25,434 INFO: perplexity: 20.082890170182278 
2024-01-03 16:42:53,286 INFO: Computing bleu... 
2024-01-03 16:42:53,667 INFO: Computing rouge... 
2024-01-03 16:42:53,679 INFO: Using default tokenizer. 
2024-01-03 16:42:54,970 INFO: Computing perplexity... 
2024-01-03 16:43:03,027 INFO: bleu-2: 0.36833061560850733 
2024-01-03 16:43:03,027 INFO: rouge-L: 0.2187052691298033 
2024-01-03 16:43:03,027 INFO: perplexity: 20.69263623331385 
2024-01-03 16:58:16,480 INFO: Computing bleu... 
2024-01-03 16:58:16,879 INFO: Computing rouge... 
2024-01-03 16:58:16,891 INFO: Using default tokenizer. 
2024-01-03 16:58:18,216 INFO: Computing perplexity... 
2024-01-03 16:58:27,490 INFO: bleu-2: 0.29259162356350754 
2024-01-03 16:58:27,490 INFO: rouge-L: 0.1832438891623308 
2024-01-03 16:58:27,490 INFO: perplexity: 22.193088514464243 
2024-01-03 17:13:01,093 INFO: Computing bleu... 
2024-01-03 17:13:01,485 INFO: Computing rouge... 
2024-01-03 17:13:01,498 INFO: Using default tokenizer. 
2024-01-03 17:13:02,834 INFO: Computing perplexity... 
2024-01-03 17:13:10,857 INFO: bleu-2: 0.3367371612447222 
2024-01-03 17:13:10,857 INFO: rouge-L: 0.19987054204712235 
2024-01-03 17:13:10,857 INFO: perplexity: 23.030990472087613 
2024-01-03 17:27:13,083 INFO: Computing bleu... 
2024-01-03 17:27:13,469 INFO: Computing rouge... 
2024-01-03 17:27:13,482 INFO: Using default tokenizer. 
2024-01-03 17:27:14,802 INFO: Computing perplexity... 
2024-01-03 17:27:22,907 INFO: bleu-2: 0.2810563081706406 
2024-01-03 17:27:22,907 INFO: rouge-L: 0.17795638857814072 
2024-01-03 17:27:22,907 INFO: perplexity: 21.942524959735834 
2024-01-03 17:41:19,503 INFO: Computing bleu... 
2024-01-03 17:41:19,892 INFO: Computing rouge... 
2024-01-03 17:41:19,904 INFO: Using default tokenizer. 
2024-01-03 17:41:21,216 INFO: Computing perplexity... 
2024-01-03 17:41:29,236 INFO: bleu-2: 0.3038004892309528 
2024-01-03 17:41:29,236 INFO: rouge-L: 0.18393235510109252 
2024-01-03 17:41:29,236 INFO: perplexity: 22.556344563089628 
2024-01-03 17:55:36,542 INFO: Computing bleu... 
2024-01-03 17:55:36,935 INFO: Computing rouge... 
2024-01-03 17:55:36,948 INFO: Using default tokenizer. 
2024-01-03 17:55:38,336 INFO: Computing perplexity... 
2024-01-03 17:55:46,697 INFO: bleu-2: 0.3117100801479655 
2024-01-03 17:55:46,697 INFO: rouge-L: 0.19367130806032495 
2024-01-03 17:55:46,697 INFO: perplexity: 22.283420981193075 
